# Manipulator upravlayemiy cherez WIFI
1. Введение
Манипуляторы, управляемые жестами, представляют собой перспективное направление в робототехнике. Они могут быть использованы в условиях, опасных для человека, таких как зоны радиационного заражения, герметичные помещения с биологическими угрозами или пространства с ограниченным доступом. Уникальность данного проекта заключается в использовании протокола ESP-NOW для низколатентной связи и модульной архитектуры, что делает его доступным для дальнейшего масштабирования и модификации.
Цель работы: Создать рабочий манипулятор, управляемый жестами руки в реальном времени через Wi-Fi.
Задачи:
1. Разработать прототип манипулятора с 4 осями управления.
2. Реализовать систему передачи данных на основе ESP-NOW.
3. Написать программный код для микросхемы.
4. Провести тестирование системы и оценить ее производительность.

















2. Теория
 В данном разделе мы расписал то, что я изучал для создания проекта.
1.	Что такое ESP-NOW
ESP-NOW — это протокол связи, разработанный для микросхем семейства ESP8266 и ESP32 от компании Espressif Systems. Он предназначен для обмена данными между устройствами без необходимости подключения к Wi-Fi сети.

2.	Как работает  ESP-NOW
ESP-NOW работает следующим образом:
Инициализация: Устройства настраиваются как отправитель и получатель.
Регистрация MAC-адресов: Каждое устройство регистрирует MAC-адрес другого для прямой связи.
Отправка данных: Отправитель передает данные, используя функцию esp_now_send().
Приём данных: Получатель получает данные через функцию обратного вызова.
Основные особенности ESP-NOW:
1.	Прямое соединение: Устройства могут обмениваться данными напрямую друг с другом через радиоканал, минуя точку доступа (Access Point). Это делает его идеальным для приложений, где требуется быстрая передача данных между несколькими устройствами.
2.	Низкая задержка: Благодаря отсутствию посредников (таких как маршрутизаторы), задержки при передаче данных минимальны, что особенно важно для приложений реального времени.
3.	Энергосбережение: Протокол оптимизирован для работы с низким энергопотреблением, что позволяет использовать его в устройствах с батарейным питанием.
4.	Простота настройки: Для использования ESP-NOW не нужно настраивать сложные сетевые параметры, такие как SSID и пароль, что упрощает интеграцию протокола в проекты.
5.	Безопасность: Поддерживается шифрование данных для защиты передаваемой информации.
3.	MPU-6050 — это интегрированный датчик движения, разработанный компанией InvenSense. Он сочетает в себе трехосевой гироскоп и трехосевой акселерометр, что позволяет измерять угловую скорость вращения и линейное ускорение по трем осям (X,Y,Z). MPU-6050 часто используется в робототехнике, системах стабилизации, игровых контроллерах и других приложениях, требующих точного отслеживания движений. Я использую только гироскоп.




3. Основная часть
3.1. Развитие технологий управления манипуляторами с помощью жестов руки становится всё более востребованным в различных отраслях. Такие системы имеют широкий спектр применений, среди которых выделяются:
o	Промышленность: в условиях повышенной опасности, например, при работе с химикатами, радиоактивными материалами или в экстремально жарких/суровых условиях, использование дистанционно управляемых манипуляторов значительно повышает безопасность операторов. Жестовое управление позволяет выполнять задачи с высокой точностью и скоростью, сохраняя жизнь и здоровье сотрудников.
o	Образование: В образовательной сфере подобные системы способствуют обучению основам робототехники и программированию. 
Уникальность проекта
Одним из ключевых преимуществ представленного проекта является использование протокола ESP-NOW. Этот протокол обеспечивает ряд уникальных характеристик, которые делают его идеальным решением для управления манипуляторами в реальном времени:aw
o	Низкая задержка передачи данных: менее 50 мс. Это критически важно для достижения плавного и естественного управления манипулятором, что особенно актуально в ситуациях, когда важна каждая доля секунды.
o	Высокая надёжность связи: Протокол ESP-NOW разработан специально для беспроводной передачи данных между устройствами, обеспечивая стабильную и устойчивую связь даже в условиях сложной радиообстановки.
Также я не нашел подобных проектов в интернете. Есть проект манипулятор, управляемый жестами  но он проводной и к тому же не работает.















3.2. Техническая спецификация
Компоненты системы:
1.	Микроконтроллеры:
o	Wemos D1 Mini (ESP8266) – 2 шт.
o	Используются для обработки данных и управления системой.
2.	Сервоприводы:
o	SG90 – 4 шт.
o	Применяются для выполнения движений манипулятора.
3.	Датчик:
o	MPU-6050
o	Измеряет угол наклона, обеспечивая данные для управления манипулятором.
Характеристики системы:
o	Задержка управления: 42 ± 5 мс
o	Низкая задержка обеспечивает плавное и отзывчивое управление манипулятором в реальном времени.
o	Точность позиционирования: ±1.5°
o	Высокая точность позволяет манипулятору точно повторять движения руки пользователя.
o	Время работы: 4 часа (с аккумулятором 10,000 мАч)
o	Длительное время автономной работы делает систему удобной для продолжительного использования без необходимости частой зарядки аккумулятора.















3.3. Архитектура системы
Система состоит из двух основных модулей: передатчика (перчатки) и приемника (манипулятора).
1. Transmitter  (Перчатка)
Перчатка считывает данные с гироскопа MPU-6050 и передает их через ESP-NOW. Она включает:
o	Гироскоп MPU-6050, измеряющий угловую скорость руки.
o	Микроконтроллер ESP8266, обрабатывающий данные и отправляющий их через ESP-NOW.
o	Кнопка, отвечает за хват.
o	Модуль Esp8266, отправляющий данные от перчатки.
2. Receiver  (Манипулятор)
Манипулятор принимает данные и преобразует их в сигналы для сервоприводов. Он содержит:
o	Модуль Esp8266, принимающий данные от перчатки.
o	Обработчик сигналов, фильтрующий и преобразующий данные в команды для сервоприводов.
o	Сервоприводы, выполняющие движения манипулятора согласно полученным данным.
Протокол ESP-NOW обеспечивает быструю и прямую связь между перчаткой и манипулятором, что критически важно для управления в реальном времени.













3.4. Программная реализация
1. Ключевые моменты кода
1.1. Receiver (приемник, манипулятор)
1.	Библиотеки. Подключение необходимых библиотек для работы с ESP-NOW и сервоприводами:
2.	Переменные.Определение глобальных переменных для хранения данных и управления сервоприводами:
3.	Указание структуры получаемых данных и преобразование их в переменные.Структура данных должна соответствовать структуре, используемой передатчиком:
4.	Инициализация ESP-NOW, указание пинов сервоприводов.Настройка ESP-NOW для приема данных и привязка сервоприводов к соответствующим пинам:
5.	Запись данных на сервоприводы.Преобразование полученных данных в углы для сервоприводов и запись их:
1.2. Transmitter (передатчик, перчатка)
1.	Библиотеки. Подключение необходимых библиотек для работы с ESP-NOW и датчиком MPU6050
2.	Переменные. Определение глобальных переменных для хранения данных и управления датчиком
3.	Указание структуры передаваемых данных и преобразование их в переменные.Структура данных должна быть согласована с приемником
4.	Задачи, которые нужно выполнить при запуске.Инициализация ESP-NOW и датчика MPU6050
5.	Считывание данных с датчика MPU6050.Чтение данных с датчика и преобразование их в нужные значения
6.	Отправка данных.Упаковка и отправка данных на приемник:
2. Оптимизации
1.	Сжатие пакетов данных до 16 байт.
2.	Динамический тайминг отправки (30-100 мс).Введение случайной задержки между передачами данных для снижения нагрузки на сеть и предотвращения коллизий.













3.5 Ход работы
Процесс создания манипулятора, управляемого жестами руки, состоял из нескольких этапов, каждый из которых играл ключевую роль в достижении конечного результата.

1. Составление схемы
На первом этапе была разработана схема электрической цепи, включающая все необходимые компоненты: микроконтроллеры, датчики, сервоприводы и модули связи. Схема подробно описывала соединения всех элементов системы и служила руководством для дальнейшей сборки. Подробная схема представлена в приложении А.

2. Распечатка деталей
После завершения проектирования схемы началась подготовка физических компонентов. Все необходимые детали были распечатаны на 3D-принтере. Это включало корпус манипулятора, крепления для сервоприводов и другие вспомогательные элементы. Качество печати было тщательно проверено, чтобы избежать дефектов, которые могли бы повлиять на работоспособность системы.

3. Сборка физической составляющей
Следующим шагом стало физическое объединение всех компонентов в единую конструкцию. Были установлены сервоприводы, подключены провода и закреплены датчики. Особое внимание уделялось надежности соединений и правильному расположению элементов, чтобы минимизировать возможные помехи и обеспечить свободный ход механизмов.

4. Разработка программного обеспечения
Когда физическая часть была собрана, начался этап написания программного кода. Код был разделен на две части: одна для передатчика (перчатки), другая для приемника (манипулятора). Каждая часть отвечала за свои функции: считывание данных с датчика, обработка и передача данных, управление сервоприводами. Код был написан с учетом особенностей используемых компонентов и протоколов связи.

5. Загрузка и калибровка
После того как код был завершен, его загрузили в микроконтроллеры. Затем последовала процедура калибровки системы. Калибровка включала настройку чувствительности датчиков, проверку корректности работы сервоприводов и тестирование связи между передатчиком и приемником. Все параметры были протестированы и при необходимости скорректированы для достижения оптимальной производительности.








3.6	Проблемы, которые были преодолены при создании проекта
1.	Дерганье манипулятора. Увеличил частоту опроса и частоту передачи данных.
2.	«Голодание электричеством»- нехватка электроэнергии. Разделил питание платы приемника и платы передатчика. Увеличил мощность питания для сервоприводов с 5w  до 25w
3.	Не диапазон измерения гироскопа и сервопривода не совпадают. Изменил функцией map()
4.	Проводная версия была неудобной, заменил ее передачей данных по ESP-NOW.
























4. Заключение
В результате проведенной работы был успешно создан манипулятор, способный управляться жестами руки в реальном времени. Разработанная система демонстрирует высокую точность и надежность, что подтверждается рядом ключевых достижений:
1.	Реализация 4-осевого управления: Манипулятор способен выполнять комплексные движения в четырех плоскостях, что значительно расширяет его функциональные возможности. 
2.	Минимальная задержка передачи данных: Особое внимание было уделено оптимизации процесса передачи данных между системой управления и самим манипулятором. Удалось достичь минимальной задержки менее 50 миллисекунд, что гарантирует плавную работу системы даже в условиях высоких требований к быстродействию.
